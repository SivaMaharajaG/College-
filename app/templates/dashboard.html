{% extends "layout.html" %}
{% block title %}Dashboard{% endblock %}
{% block content %}
<h2>My Dashboard</h2>
<h4>Marks</h4>
<canvas id="marksChart" height="100"></canvas>
<script>
fetch("/student/api/marks")
  .then(res => res.json())
  .then(data => {
    const labels = data.map(d => d.subject);
    const values = data.map(d => d.percent);
    const ctx = document.getElementById("marksChart").getContext("2d");
    new Chart(ctx, {
      type: "bar",
      data: {
        labels,
        datasets: [{
          label: "Percentage",
          data: values,
          backgroundColor: "rgba(54, 162, 235, 0.6)"
        }]
      },
      options: {
        responsive: true,
        scales: { y: { beginAtZero: true, max: 100 } }
      }
    });
  });
</script>
<h4 class="mt-5">Attendance</h4>
<table class="table table-sm">
  <thead><tr><th>Date</th><th>Subject</th><th>Status</th></tr></thead>
  <tbody>
    {% for a in attendance %}
    <tr>
      <td>{{ a.date }}</td>
      <td>{{ a.subject }}</td>
      <td>{{ a.status }}</td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endblock %}
